name: Deploy to FTP

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Create Directory for Deployment
        run: |
          # Create the directory if it doesn't exist within the GitHub Actions workspace
          mkdir -p $GITHUB_WORKSPACE/sreee

      - name: Deploy to FTP
        run: |
          # Install lftp if it's not already available
          sudo apt-get update
          sudo apt-get install lftp -y

          # Use lftp to copy files to the FTP server
          lftp -u ${{ secrets.FTP_USERNAME }},${{ secrets.FTP_PASSWORD }} ${{ secrets.FTP_HOSTNAME }} -e "mirror -R -e $GITHUB_WORKSPACE/sreee ${{ secrets.FTP_PATH }}"

        env:
          FTP_HOSTNAME: ${{ secrets.FTP_HOSTNAME }}
          FTP_USERNAME: ${{ secrets.FTP_USERNAME }}
          FTP_PASSWORD: ${{ secrets.FTP_PASSWORD }}
          FTP_PATH: ${{ secrets.FTP_PATH }}
